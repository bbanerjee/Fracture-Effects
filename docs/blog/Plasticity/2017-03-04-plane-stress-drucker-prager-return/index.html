<!DOCTYPE HTML>
<html class="no-js" lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The plane stress return algorithm</title>
  <link rel="stylesheet" href="https://bbanerjee.github.io/ParSim/assets/css/screen.css">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7cVolkhov:400,700' rel='stylesheet' type='text/css'>
  <script src="https://bbanerjee.github.io/ParSim/assets/js/modernizr.min.js"></script>
</head>


<body class="wrap">

  <script type="text/javascript"
    src="http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML">
  </script>

  <header>
  <div class="grid">
    <div class="unit one-third center-on-mobiles">
      <h1>
        <a href="/">
          <span class="sr-only">ParSim</span>
          <img src="https://bbanerjee.github.io/ParSim/assets/img/ParresiaLogoDec2016.png" 
               width="249" height="115" alt="ParSim">
        </a>
      </h1>
    </div>
    <nav class="main-nav unit two-thirds hide-on-mobiles">
      <ul>
  <li class="">
    <a href="https://bbanerjee.github.io/ParSim">Home</a>
  </li>
  <li class="current">
    <a href="https://bbanerjee.github.io/ParSim/docs/home">Vaango Docs</a>
  </li>
  <li>
    <a href="https://github.com/bbanerjee/ParSim">GitHub Source</a>
  </li>
</ul>

    </nav>
  </div>
</header>



    <section class="docs">
    <div class="grid">

      <div class="unit four-fifths">
        <article>
          <h1>The plane stress return algorithm</h1>
          <ul class="notice--content" id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#review-of-3d-plasticity" id="markdown-toc-review-of-3d-plasticity">Review of 3D plasticity</a></li>
  <li><a href="#plane-stress-plasticity" id="markdown-toc-plane-stress-plasticity">Plane stress plasticity</a></li>
  <li><a href="#forward-euler-return-algorithm" id="markdown-toc-forward-euler-return-algorithm">Forward Euler Return algorithm</a></li>
  <li><a href="#remarks" id="markdown-toc-remarks">Remarks</a></li>
</ul>

<h5 id="introduction">Introduction</h5>
<p>In the <a href="https://bbanerjee.github.io/ParSim/mechanics/plasticity/algorithm/plane-stress-drucker-prager/">previous part</a>
of this discussion, I derived plane stress expressions for linear elasticity, the Drucker-Prager
yield function, and the associated flow rule.</p>

<p>Let us now review the approach used for finding the parameter <script type="math/tex">\dot{\lambda}</script> that is needed
in return algorithms, from a purely algebraic standpoint.</p>

<p class="notice--warning">Warning: We are dealing only with perfect plasticity (no hardening) in this
series of articles.</p>

<h5 id="review-of-3d-plasticity">Review of 3D plasticity</h5>
<p>If we assume an additive decomposition of the elastic and plastic strains, the linear elastic
stress-strain relation can be expressed in tensor notation as</p>
<div>
$$
  \boldsymbol{\sigma} = \mathbf{C} : \boldsymbol{\varepsilon}^e
    = \mathbf{C} : (\boldsymbol{\varepsilon} - \boldsymbol{\varepsilon}^p)
$$
</div>
<p>The flow rule can be written as</p>
<div>
$$
  \dot{\boldsymbol{\varepsilon}}^p = \dot{\lambda} \frac{\partial f}{\partial\boldsymbol{\sigma}} =: \dot{\lambda} \boldsymbol{n}
$$
</div>
<p>and the consistency condition is</p>
<div>
$$
  \dot{f} = 0 \,.
$$
</div>
<p>From the consistency condition, the flow rule, and the stress-strain relation, we have</p>
<div>
$$
  \dot{f} = \frac{\partial f}{\partial \boldsymbol{\sigma}} : \dot{\boldsymbol{\sigma}}
    = \boldsymbol{n} :
      \mathbf{C} : (\dot{\boldsymbol{\varepsilon}} - \dot{\boldsymbol{\varepsilon}}^p)
    = \boldsymbol{n} :
      \mathbf{C} : (\dot{\boldsymbol{\varepsilon}} - \dot{\lambda} \boldsymbol{n}) = 0
$$
</div>
<p>Solving for <script type="math/tex">\dot{\lambda}</script>, we have</p>
<div class="notice">
$$
  \dot{\lambda} = \frac{\boldsymbol{n} :
      \mathbf{C} : \dot{\boldsymbol{\varepsilon}}}{ \boldsymbol{n} :
      \mathbf{C} : \boldsymbol{n}} \ge 0
$$
</div>

<p>The elastic-plastic tangent modulus can be computed from the stress-strain relation:</p>
<div>
$$
  \dot{\boldsymbol{\sigma}} = \mathbf{C} : (\dot{\boldsymbol{\varepsilon}} - \dot{\boldsymbol{\varepsilon}}^p) = \mathbf{C} : (\dot{\boldsymbol{\varepsilon}} - \dot{\lambda} \boldsymbol{n})
  =  \mathbf{C} : \left(\dot{\boldsymbol{\varepsilon}} -  \frac{\boldsymbol{n} :
      \mathbf{C} : \dot{\boldsymbol{\varepsilon}}}{ \boldsymbol{n} :
      \mathbf{C} : \boldsymbol{n}} \boldsymbol{n}\right)
$$
</div>
<p>or,</p>
<div class="notice">
$$
  \dot{\boldsymbol{\sigma}} = \left[\mathbf{C} -
    \frac{
      (\mathbf{C}: \boldsymbol{n}) \otimes \left(\boldsymbol{n} : \mathbf{C}\right)
    }{
      \boldsymbol{n} : \mathbf{C} : \boldsymbol{n}
    }\right] : \dot{\boldsymbol{\varepsilon}} =: \mathbf{C}^{ep} : \dot{\boldsymbol{\varepsilon}}
$$
</div>

<p>We will now specialize these results for plane stress conditions.</p>

<h5 id="plane-stress-plasticity">Plane stress plasticity</h5>
<p>For plane stress Drucker-Prager non-hardening associated plasticity, the above relations
can be expressed in terms of matrices and vectors.</p>

<p>The linear elastic stress-strain relation becomes</p>
<div>
$$
  \boldsymbol{\sigma} = \mathbf{C}\, \boldsymbol{\varepsilon}^e = 
    \mathbf{C}\, (\boldsymbol{\varepsilon} - \boldsymbol{\varepsilon}^p)
$$
</div>
<p>or</p>
<div>
$$
  \begin{bmatrix} \sigma_{11} \\ \sigma_{22} \\ \sigma_{12} \end{bmatrix} =
  \begin{bmatrix} \frac{4\mu(\lambda+\mu)}{\lambda+2\mu} &amp; \frac{2\mu\lambda}{\lambda+2\mu} &amp; 0 \\
                  \frac{2\mu\lambda}{\lambda+2\mu} &amp; \frac{4\mu(\lambda+\mu)}{\lambda+2\mu} &amp; 0 \\
                  0 &amp; 0 &amp; \mu
  \end{bmatrix}
  \begin{bmatrix} \varepsilon_{11} - \varepsilon_{11}^p \\
                  \varepsilon_{22} - \varepsilon_{22}^p \\ 
                  2(\varepsilon_{12} - \varepsilon_{12}^p) \end{bmatrix}
$$
</div>
<p>The yield function is</p>
<div>
$$
  f(\boldsymbol{\sigma}) = \sqrt{\tfrac{1}{2} \boldsymbol{\sigma}^T \,\mathbf{P} \,\boldsymbol{\sigma}} - q(p) = 0 
$$
</div>
<p>and the flow rule is</p>
<div>
$$
  \dot{\boldsymbol{\varepsilon}}^p = \dot{\lambda}\,\boldsymbol{n} = 
    \dot{\lambda} \left(
     \tfrac{1}{\sqrt{2}}
       \frac{\mathbf{P}\,\boldsymbol{\sigma}}{
         \sqrt{\boldsymbol{\sigma}^T\,\mathbf{P}\,\boldsymbol{\sigma}}
       }
     - \tfrac{1}{3} \frac{dq}{dp}\,\mathbf{I}
   \right)
$$
<div>$$\boldsymbol{n} = \begin{bmatrix} n_{11} &amp; n_{22} &amp; n_{12} \end{bmatrix}^T \,.$$</div>
</div>
<p>From the consistency condition, the flow rule, and the stress-strain relation, we have</p>
<div>
$$
  \begin{align}
  \dot{f} &amp; = n_{11}\dot{\sigma}_{11} + n_{12}\dot{\sigma}_{12} +
              n_{21}\dot{\sigma}_{21} + n_{22}\dot{\sigma}_{22}  = 
              \begin{bmatrix} n_{11} &amp; n_{22} &amp; 2n_{12} \end{bmatrix}
              \begin{bmatrix} \dot{\sigma}_{11} \\ \dot{\sigma}_{22} \\ \dot{\sigma}_{12} \end{bmatrix} \\
          &amp; = \begin{bmatrix} n_{11} &amp; n_{22} &amp; 2n_{12} \end{bmatrix}
              \begin{bmatrix} C_{11} &amp; C_{12} &amp; 0 \\ C_{12} &amp; C_{22} &amp; 0 \\ 0 &amp; 0 &amp; C_{33}
              \end{bmatrix}
              \begin{bmatrix} \dot{\varepsilon}_{11} - \dot{\lambda} n_{11} \\
                              \dot{\varepsilon}_{22} - \dot{\lambda} n_{22} \\ 
                              2(\dot{\varepsilon}_{12} - \dot{\lambda} n_{12}) \end{bmatrix}
           = 0
  \end{align}
$$
</div>
<p>Solving for <script type="math/tex">\dot{\lambda}</script>, we have</p>
<div class="notice">
$$
  \dot{\lambda} = \frac{\mathbf{n}^T\,\mathbf{C}\,\dot{\boldsymbol{\varepsilon}}}
                       {\mathbf{n}^T\,\mathbf{C}\,\mathbf{n}} \ge 0 \quad \text{where} \quad
  \mathbf{n}^T = \begin{bmatrix} n_{11} &amp; n_{22} &amp; 2n_{12} \end{bmatrix} \,.
$$
</div>

<p>The elastic-plastic tangent modulus is computed from the stress-strain relation</p>
<div>
$$
  \dot{\boldsymbol{\sigma}} =
    \mathbf{C}\,(\dot{\boldsymbol{\varepsilon}} - \dot{\boldsymbol{\varepsilon}}^p) =
    \mathbf{C}\,(\dot{\boldsymbol{\varepsilon}} - \dot{\lambda} \boldsymbol{n})
  =  \mathbf{C}\,\left(\dot{\boldsymbol{\varepsilon}} -
       \frac{\mathbf{n}^T\,\mathbf{C}\,\dot{\boldsymbol{\varepsilon}}}
            {\mathbf{n}^T\,\mathbf{C}\,\mathbf{n}} \,\boldsymbol{n}\right)
$$
</div>
<p>to get</p>
<div class="notice">
$$
  \dot{\boldsymbol{\sigma}} =
     \left(\mathbf{C} -
          \frac{\mathbf{C}\,\boldsymbol{n}\,\mathbf{n}^T\,\mathbf{C}}
               {\mathbf{n}^T\,\mathbf{C}\,\mathbf{n}}
     \right) \dot{\boldsymbol{\varepsilon}} = \mathbf{C}^{ep} \, \dot{\boldsymbol{\varepsilon}}
$$
</div>

<p class="notice--warning">Vectors <script type="math/tex">\boldsymbol{n}</script> and <script type="math/tex">\mathbf{n}</script> are related by</p>
<div class="notice--warning">
$$
  \mathbf{n} = \begin{bmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 2 \end{bmatrix} \boldsymbol{n}
$$
</div>

<p>Next we will see the return algorithm for this problem.</p>

<h4 id="forward-euler-return-algorithm">Forward Euler Return algorithm</h4>
<p>Let us define a trial elastic stress rate</p>
<div>
$$
  \dot{\boldsymbol{\sigma}}^{\text{trial}} = \mathbf{C} : \dot{\boldsymbol{\varepsilon}}
$$
</div>
<p>We can express the stress-strain rate relation as</p>
<div>
$$
  \dot{\boldsymbol{\sigma}} = \mathbf{C} : \dot{\boldsymbol{\varepsilon}}^e 
      = \mathbf{C} : (\dot{\boldsymbol{\varepsilon}} - \dot{\boldsymbol{\varepsilon}}^p )
      = \mathbf{C} : (\dot{\boldsymbol{\varepsilon}} - \dot{\lambda}\boldsymbol{n} )
      = \dot{\boldsymbol{\sigma}}^{\text{trial}} - \dot{\lambda}\,\mathbf{C} : \boldsymbol{n}
$$
</div>
<p>From the consistency condition</p>
<div>
$$
  \dot{f} = \boldsymbol{n} : \dot{\boldsymbol{\sigma}}
      = \boldsymbol{n} : (
        \dot{\boldsymbol{\sigma}}^{\text{trial}} - \dot{\lambda}\,\mathbf{C} : \boldsymbol{n})
      = 0
$$
</div>
<p>Therefore,</p>
<div>
$$
  \dot{\lambda} = \frac{\boldsymbol{n} : \dot{\boldsymbol{\sigma}}^{\text{trial}}}
                       {\boldsymbol{n} : \mathbf{C} : \boldsymbol{n}}
$$
</div>
<p>And we get the stress rate in terms of the trial stress rate:</p>
<div class="notice">
$$
  \dot{\boldsymbol{\sigma}} = 
      \dot{\boldsymbol{\sigma}}^{\text{trial}} -
      \left(\frac{\boldsymbol{n} : \dot{\boldsymbol{\sigma}}^{\text{trial}}}
                       {\boldsymbol{n} : \mathbf{C} : \boldsymbol{n}}\right)
      \,\mathbf{C} : \boldsymbol{n}
   = \left[\mathbf{I}^{(4)} - \frac{(\boldsymbol{n}:\mathbf{C})\otimes\boldsymbol{n}}
                             {\boldsymbol{n} : \mathbf{C} : \boldsymbol{n}}\right] : 
      \dot{\boldsymbol{\sigma}}^{\text{trial}} 
$$
</div>
<p>In the discrete form of the return algorithm we assume that we know the state at time <script type="math/tex">t_n</script> and
will calculate the state at time <script type="math/tex">t_{n+1}</script>.  To integrate the above equation we 
go back to matrix notation and observe that</p>
<div>
$$
  \boldsymbol{\sigma}_{n+1}^{\text{trial}} = \boldsymbol{\sigma}_n +
    \mathbf{C}\,(\boldsymbol{\varepsilon}_{n+1} - \boldsymbol{\varepsilon}_{n})
   = \mathbf{C}\,(\boldsymbol{\varepsilon}_{n+1} - \boldsymbol{\varepsilon}_{n}^p)
$$
</div>

<p>The actual stress that we want to compute is</p>
<div>
$$
  \boldsymbol{\sigma}_{n+1} = \mathbf{C}\,\boldsymbol{\varepsilon}_{n+1}^e 
   = \mathbf{C}\,(\boldsymbol{\varepsilon}_{n+1} - \boldsymbol{\varepsilon}_{n+1}^p)
$$
</div>

<p>We integrate the flow rule using forward Euler to get</p>
<div>
$$
  \boldsymbol{\varepsilon}_{n+1}^p =
    \boldsymbol{\varepsilon}_{n}^p + \dot{\lambda} \Delta t \, \boldsymbol{n}_{n} = 
    \boldsymbol{\varepsilon}_{n}^p + \Delta\lambda \, \boldsymbol{n}_{n}
$$
</div>

<p>Therefore, we have</p>
<div class="notice">
$$
  \boldsymbol{\sigma}_{n+1} 
   = \mathbf{C}\,(\boldsymbol{\varepsilon}_{n+1} -
    \boldsymbol{\varepsilon}_{n}^p - \Delta\lambda \, \boldsymbol{n}_{n})
   = \boldsymbol{\sigma}_{n+1}^{\text{trial}} - \Delta\lambda \,\mathbf{C}\, \boldsymbol{n}_{n}
$$
</div>

<p>We don’t know <script type="math/tex">\Delta\lambda</script> and <script type="math/tex">\boldsymbol{\sigma}_{n+1}</script> yet.
To find <script type="math/tex">\Delta\lambda</script> we use the consistency condition:</p>
<div>
$$
  f(\boldsymbol{\sigma}_{n+1}) = 0 = 
  \sqrt{\tfrac{1}{2} \boldsymbol{\sigma}_{n+1}^T \,\mathbf{P} \,\boldsymbol{\sigma}_{n+1}} - q(p_{n+1}) 
$$
</div>
<p>At this stage we are ready to get into some unpleasant algebra.</p>

<h4 id="remarks">Remarks</h4>
<p>We will explore the rest of the algebra and the backward Euler return algorithm in the next
article in this series after a short break.</p>

<p>If you have questions/comments/corrections, please contact banerjee at parresianz dot com dot zen (without the dot zen).</p>

<p><a class="twitter-share-button" href="https://twitter.com/intent/tweet" data-via="parresianz"> Tweet</a>
<script src="//platform.linkedin.com/in.js" type="text/javascript">
  lang: en_US
</script>
<script type="IN/Share" data-counter="right"></script></p>


          





  
  

  
  

  
  

  
  

  
  


        </article>
      </div>

      <div class="unit one-fifth hide-on-mobiles">
  <aside>
    
    <h4>Getting Started</h4>
    <ul>

  
  
  <li class=""><a href="https://bbanerjee.github.io/ParSim/docs/home/">Welcome</a></li>

  
  
  <li class=""><a href="https://bbanerjee.github.io/ParSim/docs/quickstart/">Quick-start guide</a></li>

  
  
  <li class=""><a href="https://bbanerjee.github.io/ParSim/docs/installation/">Installation</a></li>

</ul>

    
    <h4>Vaango tutorials</h4>
    <ul>

  
  
  <li class=""><a href="https://bbanerjee.github.io/ParSim"></a></li>

</ul>

    
    <h4>Vaango manuals</h4>
    <ul>

  
  
  <li class=""><a href="https://bbanerjee.github.io/ParSim"></a></li>

</ul>

    
  </aside>
</div>


      <div class="clear"></div>

    </div>
  </section>


  <footer>
  <div class="grid">
    <div class="unit one-third center">
      <p>&copy;&nbsp;2017 under the terms of the <a href="https://github.com/bbanerjee/ParSim/blob/master/LICENSE">MIT&nbsp;License</a>.</p>
    </div>
    <div class="unit one-third align-right center">
      <p>
        Built with
        <a href="https://jekyllrb.com">
          <img src="https://bbanerjee.github.io/ParSim/assets/img/logo-2x.png" width = "70" height="30" alt="Jekyll">
        </a>
      </p>
    </div>
    <div class="unit one-third align-right center">
      <p>
        Hosted by
        <a href="https://github.com">
          <img src="https://bbanerjee.github.io/ParSim/assets/img/footer-logo.png" width="100" height="30" alt="GitHub • Social coding">
        </a>
      </p>
    </div>
  </div>
</footer>

  <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<span class=\"sr-only\">Permalink</span><i class=\"fa fa-link\"></i>";
    anchor.title = "Permalink";
    return anchor;
  };

  var linkifyAnchors = function (level, containingElement) {
    var headers = containingElement.getElementsByTagName("h" + level);
    for (var h = 0; h < headers.length; h++) {
      var header = headers[h];

      if (typeof header.id !== "undefined" && header.id !== "") {
        header.appendChild(anchorForId(header.id));
      }
    }
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var contentBlock = document.getElementsByClassName("docs")[0] || document.getElementsByClassName("news")[0];
      if (!contentBlock) {
        return;
      }
      for (var level = 1; level <= 6; level++) {
        linkifyAnchors(level, contentBlock);
      }
    }
  };
</script>

  
</body>
</html>
