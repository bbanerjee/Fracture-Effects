<!DOCTYPE HTML>
<html class="no-js" lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The CFL condition for explicit discrete element methods:1</title>
  <link rel="stylesheet" href="https://bbanerjee.github.io/ParSim//assets/css/screen.css">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7cVolkhov:400,700' rel='stylesheet' type='text/css'>
  <script src="https://bbanerjee.github.io/ParSim//assets/js/modernizr.min.js"></script>
</head>


<body class="wrap">

  <script type="text/javascript"
    src="http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML">
  </script>

  <header>
  <div class="grid">
    <div class="unit one-third center-on-mobiles">
      <h1>
        <a href="/">
          <span class="sr-only">ParSim</span>
          <img src="https://bbanerjee.github.io/ParSim//assets/img/ParresiaLogoDec2016.png" 
               width="249" height="115" alt="ParSim">
        </a>
      </h1>
    </div>
    <nav class="main-nav unit two-thirds hide-on-mobiles">
      <ul>
  <li class="">
    <a href="https://bbanerjee.github.io/ParSim/">Home</a>
  </li>
  <li class="current">
    <a href="https://bbanerjee.github.io/ParSim//docs/home">Vaango Docs</a>
  </li>
  <li>
    <a href="https://github.com/bbanerjee/ParSim">GitHub Source</a>
  </li>
</ul>

    </nav>
  </div>
</header>



    <section class="docs">
    <div class="grid">

      <div class="unit four-fifths">
        <article>
          <h1>The CFL condition for explicit discrete element methods:1</h1>
          <link rel="stylesheet" type="text/css" href="https://bbanerjee.github.io/ParSim//assets/js/animateCFL.css" />

<ul class="notice--content" id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#the-cfl-condition" id="markdown-toc-the-cfl-condition">The CFL condition</a></li>
  <li><a href="#remarks" id="markdown-toc-remarks">Remarks</a></li>
</ul>

<h4 id="introduction">Introduction</h4>
<p>Solutions of hyperbolic partial differential equations using explicit numerical methods
need a means of limiting the timestep so that the solution is stable.  A criterion 
that is usually used to constrain the step size is the 
<a href="https://en.wikipedia.org/wiki/Courant%E2%80%93Friedrichs%E2%80%93Lewy_condition">Courant–Friedrichs–Lewy condition</a>.</p>

<p>Let us first explore what the 1928 paper by the Courant, Friedrichs, and Lewy had to say on
stability.  I will then examine the von Neumann form of the condition that is widely used
in forward difference calculations.  Finally, I will say something about the application of these
ideas to discrete element methods.  Depending on my patience, I’ll probably break up the article
into two or three parts.</p>

<h4 id="the-cfl-condition">The CFL condition</h4>
<p>The easiest starting point for the analysis is the one-dimensional wave equation:</p>
<div>
$$
  \frac{\partial^2 u}{\partial t^2} - \frac{\partial^2 u}{\partial x^2} = 0 \,.
$$
</div>
<p>Let us assume that the value of the solution <script type="math/tex">u(x,t)</script> and its derivatives are known
at time <script type="math/tex">t = 0</script>.</p>

<p>If we use a grid size <script type="math/tex">\Delta x</script> and a timestep <script type="math/tex">\Delta t</script>, the derivatives can be expressed as</p>
<div>
$$
 \begin{align}
  \frac{\partial^2 u}{\partial x^2} \approx u_{xx} &amp; =
    \frac{1}{\Delta x^2}[u(x+\Delta x, t) - 2u(x, t) + u(x-\Delta x, t)] \\
  \frac{\partial^2 u}{\partial t^2} \approx u_{tt} &amp; =
    \frac{1}{\Delta t^2}[u(x, t+\Delta t) - 2u(x, t) + u(x, t-\Delta t)] \,.
 \end{align}
$$
</div>

<p>Consider the case where <script type="math/tex">\Delta t = h</script> and <script type="math/tex">\Delta x = kh</script>. In
that case, the 1D wave equation can be discretized as</p>
<div>
$$
  u(x, t+h) + u(x, t-h) - u(x+kh, t) + u(x-kh, t) = 0  \,.
$$
</div>

<p>This implies that each point <script type="math/tex">x</script> has an evolving region of influence that grows
as shown (for <script type="math/tex">k=1</script>) in the animation below, i.e., the value at that point has an immediate effect only on
points in the region of influence (also called <strong>domain of dependence</strong>).</p>

<div class="cfl-wave-animation">
</div>

<p>Similarly, there is a <strong>mathematical domain of dependence</strong> of the underlying hyperbolic
PDE that is exact.  What the CFL paper found was that</p>

<blockquote>
  <p>The domain of dependence for the difference equation for this mesh will now either lie entirely within
the domain of dependence of the differential equation, or on the other hand will contain this latter
region inside its own domain according as k &lt; 1 or k &gt; 1 respectively</p>
</blockquote>

<p>This finding implies that if k &lt; 1, the domain of dependence (DoD) of the discrete equation is inside
the DoD of the original PDE.  You can see that in the animation below (use the slider to
change the value of <script type="math/tex">k</script> to 0.5).  In the animation we have kept <script type="math/tex">h = \Delta t</script> constant and the
green lines are a proxy for the mathematical domain of dependence.</p>

<div class="cfl-domain-animation">
</div>

<p>If we decrease <script type="math/tex">h</script>, and keep k &lt; 1, the domain of dependence of the discrete equation
becomes smaller relative to the mathematical (exact) domain!  Therefore the discrete solution 
will not converge to the exact solution if k &lt; 1, however small we choose the value of <script type="math/tex">h</script> to be.</p>

<p>The CFL paper also proved that convergence is indeed achieved for <script type="math/tex">k > 1</script>,
or, in this case,</p>
<div>
$$
  \frac{\Delta x}{\Delta t} &gt; 1\,.
$$
</div>

<p>The same observation is true for many different types or linear and nonlinear PDEs.  With that
is mind, We can write the CFL condition as described in the Courant-Friedrich-Lewy paper as follows.</p>

<p class="notice--info"><strong>The CFL Condition</strong>  For each point in the domain of a PDE, the CFL condition is
satisfied if the mathematical domain of dependence is contained in the
numerical domain of dependence.</p>

<p class="notice--info"><strong>The CFL Theorem</strong> The CFL condition is a necessary condition for the <strong>convergence</strong> of a
numerical approximation of a PDE.
The <a href="https://en.wikipedia.org/wiki/Lax_equivalence_theorem">Lax Equivalence Theorem</a>
then implies that the
CFL condition is also a necessary condition for the <strong>stability</strong> of the numerical scheme if the PDE is linear.</p>

<h4 id="remarks">Remarks</h4>
<p>While this is a powerful general result, the constraint is not tight enough for practical 
calculations.  The von Neumann result that will be discussed in the next part of this series
will show how we can come up with a easier way of computing stability conditions for linear PDEs.</p>

<p>The animations are a bit buggy at this point but will do for the purposes of this article.</p>

<p>If you have questions/comments/corrections, please contact banerjee at parresianz dot com dot zen (without the dot zen).</p>

<p><a class="twitter-share-button" href="https://twitter.com/intent/tweet" data-via="parresianz"> Tweet</a>
<script src="//platform.linkedin.com/in.js" type="text/javascript">
  lang: en_US
</script>
<script type="IN/Share" data-counter="right"></script></p>

<script src="https://bbanerjee.github.io/ParSim//assets/js/d3.v4.min.js"></script>

<script src="https://bbanerjee.github.io/ParSim//assets/js/animateWave.js"></script>

<script src="https://bbanerjee.github.io/ParSim//assets/js/animateCFL.js"></script>


          





  
  

  
  

  
  

  
  

  
  

        </article>
      </div>

      <div class="unit one-fifth hide-on-mobiles">
  <aside>
    
    <h4>Getting Started</h4>
    <ul>

  
  
  <li class=""><a href="/docs/home/">Welcome</a></li>

  
  
  <li class=""><a href="/docs/quickstart/">Quick-start guide</a></li>

  
  
  <li class=""><a href="/docs/installation/">Installation</a></li>

</ul>

    
    <h4>Vaango tutorials</h4>
    <ul>

  
  
  <li class=""><a href=""></a></li>

</ul>

    
    <h4>Vaango manuals</h4>
    <ul>

  
  
  <li class=""><a href=""></a></li>

</ul>

    
  </aside>
</div>


      <div class="clear"></div>

    </div>
  </section>


  <footer>
  <div class="grid">
    <div class="unit one-third center">
      <p>&copy;&nbsp;2017 under the terms of the <a href="https://github.com/bbanerjee/ParSim/blob/master/LICENSE">MIT&nbsp;License</a>.</p>
    </div>
    <div class="unit one-third align-right center">
      <p>
        Built with
        <a href="https://jekyllrb.com">
          <img src="https://bbanerjee.github.io/ParSim//assets/img/logo-2x.png" width = "70" height="30" alt="Jekyll">
        </a>
      </p>
    </div>
    <div class="unit one-third align-right center">
      <p>
        Hosted by
        <a href="https://github.com">
          <img src="https://bbanerjee.github.io/ParSim//assets/img/footer-logo.png" width="100" height="30" alt="GitHub • Social coding">
        </a>
      </p>
    </div>
  </div>
</footer>

  <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<span class=\"sr-only\">Permalink</span><i class=\"fa fa-link\"></i>";
    anchor.title = "Permalink";
    return anchor;
  };

  var linkifyAnchors = function (level, containingElement) {
    var headers = containingElement.getElementsByTagName("h" + level);
    for (var h = 0; h < headers.length; h++) {
      var header = headers[h];

      if (typeof header.id !== "undefined" && header.id !== "") {
        header.appendChild(anchorForId(header.id));
      }
    }
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var contentBlock = document.getElementsByClassName("docs")[0] || document.getElementsByClassName("news")[0];
      if (!contentBlock) {
        return;
      }
      for (var level = 1; level <= 6; level++) {
        linkifyAnchors(level, contentBlock);
      }
    }
  };
</script>

  
</body>
</html>
