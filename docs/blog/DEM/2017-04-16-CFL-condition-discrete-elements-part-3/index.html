<!DOCTYPE HTML>
<html class="no-js" lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The CFL condition for explicit discrete element methods:3</title>
  <link rel="stylesheet" href="https://bbanerjee.github.io/ParSim/assets/css/screen.css">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7cVolkhov:400,700' rel='stylesheet' type='text/css'>
  <script src="https://bbanerjee.github.io/ParSim/assets/js/modernizr.min.js"></script>
</head>


<body class="wrap">

  <script type="text/javascript"
    src="http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML">
  </script>

  <header>
  <div class="grid">
    <div class="unit one-third center-on-mobiles">
      <h1>
        <a href="/">
          <span class="sr-only">ParSim</span>
          <img src="https://bbanerjee.github.io/ParSim/assets/img/ParresiaLogoDec2016.png" 
               width="249" height="115" alt="ParSim">
        </a>
      </h1>
    </div>
    <nav class="main-nav unit two-thirds hide-on-mobiles">
      <ul>
  <li class="">
    <a href="https://bbanerjee.github.io/ParSim">Home</a>
  </li>
  <li class="current">
    <a href="https://bbanerjee.github.io/ParSim/docs/home">Vaango Docs</a>
  </li>
  <li>
    <a href="https://github.com/bbanerjee/ParSim">GitHub Source</a>
  </li>
</ul>

    </nav>
  </div>
</header>



    <section class="docs">
    <div class="grid">

      <div class="unit four-fifths">
        <article>
          <h1>The CFL condition for explicit discrete element methods:3</h1>
          <ul class="notice--content" id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#eulers-laws-of-motion" id="markdown-toc-eulers-laws-of-motion">Euler’s laws of motion</a></li>
  <li><a href="#discretization-of-euler-equations" id="markdown-toc-discretization-of-euler-equations">Discretization of Euler equations</a></li>
  <li><a href="#stability-of-central-difference-scheme" id="markdown-toc-stability-of-central-difference-scheme">Stability of central difference scheme</a>    <ul>
      <li><a href="#one-dimensional-unforced-system" id="markdown-toc-one-dimensional-unforced-system">One-dimensional unforced system</a></li>
      <li><a href="#stability-using-the-hurwitz-matrix-approach" id="markdown-toc-stability-using-the-hurwitz-matrix-approach">Stability using the Hurwitz matrix approach</a></li>
    </ul>
  </li>
  <li><a href="#remarks" id="markdown-toc-remarks">Remarks</a></li>
</ul>

<h4 id="introduction">Introduction</h4>
<p>In <a href="https://bbanerjee.github.io/ParSim/dem/CFL-condition-discrete-elements/">Part 1</a> of this article,
we revisited the CFL condition and in <a href="https://bbanerjee.github.io/ParSim/dem/CFL-condition-discrete-elements-part-2/">Part 2</a> we showed how the CFL condition and the von Neumann stability condition are
identical for linear wave equation PDEs.</p>

<p>Both these conditions apply to PDEs for continuous systems (with the possibility
of shocks) that have been discretized.  However, the discrete element method is
discretizes a set of coupled ODEs that apply to each rigid particle in a system.
Does it even make sense to talk about the CFL condition for discrete elements?</p>

<p>I suggest we should just use the term “stability condition” for discrete element 
methods. Even though a system of discrete particles can exhibit wave-like behavior,
it is not straightforward to connect the behavior of the system to an equivalent
PDE that can be analyzed using the CFL/von Neumann techniques.</p>

<p>First, let us explore the ODEs governing a single rigid body and then examine the
numerical stability of the ODE during integration.</p>

<h4 id="eulers-laws-of-motion">Euler’s laws of motion</h4>
<p>Discrete element methods model systems of objects as rigid bodies that interact
via contact.  The motion of a single rigid body with respect to an <strong>inertial frame</strong>
can be described using <strong>Euler’s equations of motion</strong>:</p>
<div>
$$
  \mathbf{f} = \frac{d\mathbf{p}}{dt} = m \frac{d\mathbf{v}}{dt} \quad \text{and} \quad
  \boldsymbol{\tau} = \frac{d\mathbf{l}}{dt} = \frac{d}{dt}(\boldsymbol{I}\cdot\boldsymbol{\Omega})
$$
</div>
<p>where <script type="math/tex">\mathbf{p}</script> is the linear momentum, <script type="math/tex">\mathbf{l}</script> is the angular momentum,
<script type="math/tex">m</script> is the mass, <script type="math/tex">\boldsymbol{I}</script> is the mass moment of inertia, <script type="math/tex">\mathbf{v}</script> is
the linear velocity, <script type="math/tex">\boldsymbol{\Omega}</script> is the angular velocity, <script type="math/tex">\mathbf{f}</script> is
the force, <script type="math/tex">\boldsymbol{\tau}</script> is the torque, and <script type="math/tex">t</script> is the time.  Note that
in this case all quantities are computed with respect to the center of mass of the body.</p>

<p>For numerical purposes, it is common to express the linear and angular velocities in
terms of derivatives of spatial position (<script type="math/tex">\mathbf{x}</script>) and
orientation (<script type="math/tex">\mathbf{\theta}</script>) as</p>
<div>
$$
  \mathbf{v} = \frac{d\mathbf{x}}{dt} \quad \text{and} \quad
  \boldsymbol{\Omega} = \frac{d\boldsymbol{\theta}}{dt}
$$
</div>

<h4 id="discretization-of-euler-equations">Discretization of Euler equations</h4>
<p>Note that both Euler equations have the form</p>
<div>
$$
  \ddot{\mathbf{x}}(t) = \mathbf{A}(\mathbf{x}(t))
$$
</div>
<p>where <script type="math/tex">\ddot{a} := d^2 a/dt^2</script>.  If we know the initial conditions <script type="math/tex">\mathbf{x}(0) = \mathbf{x}_0</script> and <script type="math/tex">\dot{\mathbf{x}}(0) = \mathbf{v}_0</script>, we can integrate the two equations
simultaneously using a <a href="https://en.wikipedia.org/wiki/Verlet_integration">Velocity-Verlet</a>
scheme:</p>
<div>
$$
  \begin{align}
  \mathbf{v}_{n+1/2} &amp; = \mathbf{v}_n + \tfrac{1}{2} \dot{\mathbf{v}}_n \Delta t 
  &amp; \boldsymbol{\Omega}_{n+1/2} &amp; = \boldsymbol{\Omega}_n +
     \tfrac{1}{2} \dot{\boldsymbol{\Omega}}_n \Delta t \\
  \mathbf{x}_{n+1} &amp; = \mathbf{x}_n + \mathbf{v}_{n+1/2} \Delta t
  &amp; \boldsymbol{\theta}_{n+1} &amp; = \boldsymbol{\theta}_n +
    \boldsymbol{\Omega}_{n+1/2} \Delta t \\
  \mathbf{v}_{n+1} &amp; = \mathbf{v}_{n+1/2} + \tfrac{1}{2} \dot{\mathbf{v}}_{n+1} \Delta t 
  &amp; \boldsymbol{\Omega}_{n+1} &amp; = \boldsymbol{\Omega}_n +
     \tfrac{1}{2} \dot{\boldsymbol{\Omega}}_{n+1} \Delta t 
  \end{align}
$$
</div>
<p class="notice--warning">Note that the angular momentum equation is typically
expressed in body coordinates to avoid a time-varying moment of inertia and solved
accordingly.</p>

<p>A more common approach is to just use a standard <strong>central difference</strong> approach, i.e.,</p>
<div>
$$
  \begin{align}
  \mathbf{v}_{n+1/2} &amp; = \mathbf{v}_{n-1/2} + \dot{\mathbf{v}}_n \Delta t 
  &amp; \boldsymbol{\Omega}_{n+1/2} &amp; = \boldsymbol{\Omega}_{n-1/2} +
     \dot{\boldsymbol{\Omega}}_n \Delta t \\
  \mathbf{x}_{n+1} &amp; = \mathbf{x}_n + \mathbf{v}_{n+1/2} \Delta t
  &amp; \boldsymbol{\theta}_{n+1} &amp; = \boldsymbol{\theta}_n +
    \boldsymbol{\Omega}_{n+1/2} \Delta t 
  \end{align}
$$
</div>

<h4 id="stability-of-central-difference-scheme">Stability of central difference scheme</h4>
<p>It is not very easy to explore the stability of the general second-order ODE in the presence
of arbitrary external forces and torques.  Instead, we can draw upon the large literature
on the subject from contact problems in finite element analysis (see <a href="https://books.google.co.nz/books?id=BQpfAQAAQBAJ&amp;dq=nonlinear+finite+elements+of+continua+and+structures">Nonlinear Finite Elements for Continua and Structures</a>, Chapter 6, for an excellent exposition) and explore the more relevant problem of contact between two rigid bodies.</p>

<p>For simplicity let us follow the approach taken by Y. T. Feng
(<em>On the central difference algorithm in discrete element modelling of impact</em>, IJNME 64:1959-1980, 2005).
We assume, as is popular in discrete element methods, that the contact between two rigid bodies
can be modeled using a one-dimensional spring-damper system where the spring has a stiffness <script type="math/tex">k</script>
and the damper has a damping coefficient <script type="math/tex">c</script>.</p>

<h5 id="one-dimensional-unforced-system">One-dimensional unforced system</h5>
<p>If there are no external forcings, the two-body system can be described by the equation</p>
<div>
$$
  m\ddot{x} + c\dot{x} + kx = 0 \,\quad x(0) = 0, \dot{x}(0) = v_0
$$
</div>
<p>This ODE has solutions of the form</p>
<div>
$$
  x(t) = e^{\alpha t}
$$
</div>
<p>Therefore we have</p>
<div>
$$
  \alpha^2 m + \alpha c + k = 0
  \quad \implies \quad
  \alpha = \frac{-c \pm \sqrt{c^2 - 4 k m}}{2m} 
$$
</div>
<p>If <script type="math/tex">c^2 > 4 km</script> the solutions are real and not oscillatory (overdamped).  On the other
hand, if <script type="math/tex">c^2 \lt 4 km</script> the solutions are imaginary and therefore oscillatory (underdamped).
The <strong>critical damping</strong> value is given by</p>
<div>
$$
  c_c^2 = 4 k m \quad \equiv \left(\frac{c_c}{2m}\right)^2 = \frac{k}{m} = \omega^2
  \quad \implies \quad c_c = 2\omega m
$$
</div>
<p>where <script type="math/tex">\omega</script> is the natural frequency of the system. Then the original ODE can be
written in terms of <script type="math/tex">c_c</script> and <script type="math/tex">\omega</script> as</p>
<div>
$$
  \ddot{x} + 2\zeta\omega\dot{x} + \omega^2 x = 0 \,\quad \text{where} \quad \zeta := \frac{c}{c_c}
$$
</div>

<h5 id="stability-using-the-hurwitz-matrix-approach">Stability using the Hurwitz matrix approach</h5>
<p>Using a central difference scheme for second derivatives and an upwind scheme for first derivatives,
we have</p>
<div>
$$
  \frac{x_{n+1} - 2 x_n + x_{n-1}}{\Delta t^2} +
  2\zeta\omega\frac{x_n - x_{n-1}}{\Delta t} + \omega^2 x_n = 0 
$$
</div>
<p>This is a linear difference equation that has solutions of the form <script type="math/tex">x_n = r^n</script> (see <a href="https://en.wikipedia.org/wiki/Recurrence_relation">Recurrence_relation</a> for a proof). Plugging in these solutions, we get</p>
<div>
$$
  \frac{r^{n+1} - 2 r^n + r^{n-1}}{\Delta t^2} +
  2\zeta\omega\frac{r^n - r^{n-1}}{\Delta t} + \omega^2 r^n = 0 
$$
</div>
<p>or</p>
<div>
$$
  \frac{r^2 - 2 r + 1}{\Delta t^2} +
  2\zeta\omega\frac{r - 1}{\Delta t} + \omega^2 r = 0 
$$
</div>
<p>or,</p>
<div>
$$
  r^2 + (g+h-2)r + (1-g) = 0 \quad \text{where} \quad g:= 2\zeta\omega\Delta t ~,~~ h := \omega^2\Delta t^2
$$
</div>
<p>We can now apply the <a href="https://en.wikipedia.org/wiki/Bilinear_transform">z-transform</a> to this
equation because <script type="math/tex">r = \exp(\gamma \Delta t)</script> (see Wikipedia article on recurrence relations)
to get</p>
<div>
$$
 \left(\frac{1+z}{1-z}\right)^2 + (g+h-2)\frac{1+z}{1-z} + (1-g) = 0
$$
</div>
<p>or</p>
<div>
$$
 (1+z)^2 + (g+h-2)(1-z^2) + (1-g)(1-z)^2 = 0
$$
</div>
<p>We can easily generate the <a href="https://en.wikipedia.org/wiki/Hurwitz_matrix">Hurwitz matrix</a>
(<script type="math/tex">\mathbf{H}</script>) of this
polynomial. Stability requires the leading principal minors of this matrix be positive.
In this case, we have</p>
<div>
$$
  \mathbf{H} = \begin{bmatrix} 2g &amp; 0 \\ 4 - 2g -h &amp; h \end{bmatrix}
    = \begin{bmatrix} 2(2\zeta\omega\Delta t) &amp; 0 \\ 4 - 2(2\zeta\omega\Delta t) -\omega^2\Delta t^2 &amp; \omega^2\Delta t^2 \end{bmatrix}
$$
</div>
<p>and the stability requirements</p>
<div>
$$
  \begin{align}
  g \ge 0  &amp; \implies \quad \zeta\omega\Delta t \ge 0 \\
  4 - 2g -h \ge 0 &amp; \implies \quad 4 - 4\zeta\omega\Delta t - \omega^2\Delta t^2 \ge 0 \\
  h \ge 0 &amp; \implies \quad \omega^2 \Delta t^2 \ge 0
  \end{align}
$$
</div>
<p>For systems with positive damping, the only non-trivial condition above is the second one
which leads to a critical timestep of</p>
<div class="notice--info">
$$
  \Delta t \le \frac{2}{\omega}(\sqrt{\zeta^2+1} - \zeta) \,.
$$
</div>
<p>Variations of this expression are often used to determine the stable time step in DEM
calculations.</p>

<h4 id="remarks">Remarks</h4>
<p>In the next part of this series we will explore a slightly more realistic model of
DEM calculations and see what can be said about the stability of that model.</p>

<p>If you have questions/comments/corrections, please contact banerjee at parresianz dot com dot zen (without the dot zen).</p>

<p><a class="twitter-share-button" href="https://twitter.com/intent/tweet" data-via="parresianz"> Tweet</a>
<script src="//platform.linkedin.com/in.js" type="text/javascript">
  lang: en_US
</script>
<script type="IN/Share" data-counter="right"></script></p>


          





  
  

  
  

  
  

  
  

  
  

        </article>
      </div>

      <div class="unit one-fifth hide-on-mobiles">
  <aside>
    
    <h4>Getting Started</h4>
    <ul>

  
  
  <li class=""><a href="/docs/home/">Welcome</a></li>

  
  
  <li class=""><a href="/docs/quickstart/">Quick-start guide</a></li>

  
  
  <li class=""><a href="/docs/installation/">Installation</a></li>

</ul>

    
    <h4>Vaango tutorials</h4>
    <ul>

  
  
  <li class=""><a href=""></a></li>

</ul>

    
    <h4>Vaango manuals</h4>
    <ul>

  
  
  <li class=""><a href=""></a></li>

</ul>

    
  </aside>
</div>


      <div class="clear"></div>

    </div>
  </section>


  <footer>
  <div class="grid">
    <div class="unit one-third center">
      <p>&copy;&nbsp;2017 under the terms of the <a href="https://github.com/bbanerjee/ParSim/blob/master/LICENSE">MIT&nbsp;License</a>.</p>
    </div>
    <div class="unit one-third align-right center">
      <p>
        Built with
        <a href="https://jekyllrb.com">
          <img src="https://bbanerjee.github.io/ParSim/assets/img/logo-2x.png" width = "70" height="30" alt="Jekyll">
        </a>
      </p>
    </div>
    <div class="unit one-third align-right center">
      <p>
        Hosted by
        <a href="https://github.com">
          <img src="https://bbanerjee.github.io/ParSim/assets/img/footer-logo.png" width="100" height="30" alt="GitHub • Social coding">
        </a>
      </p>
    </div>
  </div>
</footer>

  <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<span class=\"sr-only\">Permalink</span><i class=\"fa fa-link\"></i>";
    anchor.title = "Permalink";
    return anchor;
  };

  var linkifyAnchors = function (level, containingElement) {
    var headers = containingElement.getElementsByTagName("h" + level);
    for (var h = 0; h < headers.length; h++) {
      var header = headers[h];

      if (typeof header.id !== "undefined" && header.id !== "") {
        header.appendChild(anchorForId(header.id));
      }
    }
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var contentBlock = document.getElementsByClassName("docs")[0] || document.getElementsByClassName("news")[0];
      if (!contentBlock) {
        return;
      }
      for (var level = 1; level <= 6; level++) {
        linkifyAnchors(level, contentBlock);
      }
    }
  };
</script>

  
</body>
</html>
