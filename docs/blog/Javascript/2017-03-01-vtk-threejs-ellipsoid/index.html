<!DOCTYPE HTML>
<html class="no-js" lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Setting up the Three.js ellipsoids</title>
  <link rel="stylesheet" href="https://bbanerjee.github.io/ParSim/assets/css/screen.css">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7cVolkhov:400,700' rel='stylesheet' type='text/css'>
  <script src="https://bbanerjee.github.io/ParSim/assets/js/modernizr.min.js"></script>
</head>


<body class="wrap">

  <script type="text/javascript"
    src="http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML">
  </script>

  <header>
  <div class="grid">
    <div class="unit one-third center-on-mobiles">
      <h1>
        <a href="/">
          <span class="sr-only">ParSim</span>
          <img src="https://bbanerjee.github.io/ParSim/assets/img/ParresiaLogoDec2016.png" 
               width="249" height="115" alt="ParSim">
        </a>
      </h1>
    </div>
    <nav class="main-nav unit two-thirds hide-on-mobiles">
      <ul>
  <li class="">
    <a href="https://bbanerjee.github.io/ParSim">Home</a>
  </li>
  <li class="current">
    <a href="https://bbanerjee.github.io/ParSim/docs/home">Vaango Docs</a>
  </li>
  <li>
    <a href="https://github.com/bbanerjee/ParSim">GitHub Source</a>
  </li>
</ul>

    </nav>
  </div>
</header>



    <section class="docs">
    <div class="grid">

      <div class="unit four-fifths">
        <article>
          <h1>Setting up the Three.js ellipsoids</h1>
          <ul class="notice--content" id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#the-ellipsoid-particles-component" id="markdown-toc-the-ellipsoid-particles-component">The ellipsoid particles component</a></li>
  <li><a href="#creating-the-ellipsoid-particles" id="markdown-toc-creating-the-ellipsoid-particles">Creating the ellipsoid particles</a></li>
  <li><a href="#remarks" id="markdown-toc-remarks">Remarks</a></li>
</ul>

<h5 id="introduction">Introduction</h5>
<p>In the previous articles in this series we talked about:</p>

<ol>
  <li><a href="https://bbanerjee.github.io/ParSim/javascript/typescript/vue/vuex/xml/reading-vtk-particles/">Part 1: Reading VTK format particles with Javascript in a browser</a></li>
  <li><a href="https://bbanerjee.github.io/ParSim/javascript/typescript/vue/vuex/vuex-store/">Part 2: Saving the read-in particle data in a Vuex store</a></li>
  <li><a href="https://bbanerjee.github.io/ParSim/javascript/typescript/threejs/vue/vtk-threejs/">Part 3: Initialization of a store and the user interface</a>.</li>
  <li><a href="https://bbanerjee.github.io/ParSim/javascript/typescript/threejs/vue/vtk-threejs-renderer/">Part 4: Setting up the Three.js renderer</a></li>
  <li><a href="https://bbanerjee.github.io/ParSim/javascript/typescript/threejs/vue/vtk-threejs-camera/">Part 5: Setting up the Three.js scene and camera</a></li>
</ol>

<p>We are now ready to discuss the <code>three-ellipsoid-particles</code> component that we introduced in 
<code>ThreeGraphicsPanel.vue</code>.  Recall that the template has the following form:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span></span><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#39;three-graphics-container&#39;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;uk-card uk-card-default uk-card-large&quot;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;uk-card-body&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">three-renderer</span> <span class="na">v-bind:size</span><span class="o">=</span><span class="s">&quot;{w:500, h:500}&quot;</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">three-scene</span> <span class="na">v-bind:size</span><span class="o">=</span><span class="s">&quot;size&quot;</span><span class="p">&gt;</span> 
            <span class="p">&lt;</span><span class="nt">three-camera</span> <span class="na">v-bind:size</span><span class="o">=</span><span class="s">&quot;size&quot;</span> <span class="na">v-bind:position</span><span class="o">=</span><span class="s">&quot;{x: 100,  z: 15 }&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">three-camera</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">three-ellipsoid-particles</span><span class="p">&gt;</span> <span class="p">&lt;/</span><span class="nt">three-ellipsoid-particles</span><span class="p">&gt;</span>
          <span class="p">&lt;/</span><span class="nt">three-scene</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">three-renderer</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span></code></pre></figure>

<h5 id="the-ellipsoid-particles-component">The ellipsoid particles component</h5>
<p>The file <code>ThreeEllipsoidParticles.vue</code> also does not contain any information inside the
<code>&lt;template&gt;</code> tags and contains the following:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span></span><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span> <span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;./ThreeEllipsoidParticles.ts&quot;</span><span class="p">&gt;</span> <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></code></pre></figure>

<p>However, the source code contains more - as you can see below.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">Vue</span> <span class="nx">from</span> <span class="s2">&quot;vue&quot;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Lifecycle</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;av-ts&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">THREE</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;three&quot;</span><span class="p">);</span>
<span class="kr">import</span> <span class="nx">Store</span> <span class="nx">from</span> <span class="s2">&quot;./Store&quot;</span><span class="p">;</span>
<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;ThreeEllipsoidParticles&#39;</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">ThreeEllipsoidParticles</span> <span class="kr">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="err">@</span><span class="nx">Lifecycle</span>
  <span class="kr">public</span> <span class="nx">created</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Create a watch in the store to make sure the particle</span>
    <span class="c1">// file has been read before particles are created</span>
    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">Store</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span>
      <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Store</span><span class="p">.</span><span class="nx">getters</span><span class="p">.</span><span class="nx">particleReadComplete</span><span class="p">;</span>
      <span class="p">},</span>
      <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Store</span><span class="p">.</span><span class="nx">getters</span><span class="p">.</span><span class="nx">particleReadComplete</span><span class="p">)</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">createThreeParticles</span><span class="p">();</span>
      <span class="p">});</span>
  <span class="p">}</span>
  <span class="c1">// Actually create the particles</span>
  <span class="kr">private</span> <span class="nx">createThreeParticles</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">.....</span> <span class="nx">see</span> <span class="nx">below</span> <span class="p">....</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>There are several aspects that need consideration in this code.</p>

<p class="notice">We use the <code>watch</code> “instance method” of <a href="https://vuex.vuejs.org/en/api.html">Vuex</a> to make sure that
the particles are added to the scene only after the particle file has been read.</p>

<p class="notice--warning">In this example
we do not stop watching the variable <code>particleReadComplete</code> (see <a href="https://bbanerjee.github.io/ParSim/javascript/typescript/vue/vuex/vuex-store/">Part 2</a> for details) after the particle data has been converted and saved.  However, that step is highly recommended.</p>

<h5 id="creating-the-ellipsoid-particles">Creating the ellipsoid particles</h5>
<p>The particle axis data are in the form of angles between the ellipsoid axes and the world coordinate axes.
These are converted directly into the appropriate rotation matrix.  Sphere objects are then created at
the origin, rotated, scaled, and translated to their actual positions.  The sphere objects are then
transformed into <code>SphereBufferGeometry</code> objects to make their manipulation slightly more efficient.
Finally, a “material” shading model is added to make sure that the image displayed isn’t flat and
a triangulated mesh is generated for each object.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span></span>  <span class="kr">private</span> <span class="nx">createThreeParticles</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Get the particle data</span>
    <span class="kd">let</span> <span class="nx">particles</span> <span class="o">=</span> <span class="nx">Store</span><span class="p">.</span><span class="nx">getters</span><span class="p">.</span><span class="nx">particleData</span><span class="p">;</span>
    <span class="c1">// Extract the radius and center</span>
    <span class="kd">let</span> <span class="nx">radii</span> <span class="o">=</span> <span class="nx">particles</span><span class="p">[</span><span class="s2">&quot;Radius&quot;</span><span class="p">];</span>
    <span class="kd">let</span> <span class="nx">centers</span> <span class="o">=</span> <span class="nx">particles</span><span class="p">[</span><span class="s2">&quot;Position&quot;</span><span class="p">];</span>
    <span class="kd">let</span> <span class="nx">axes_a</span> <span class="o">=</span> <span class="nx">particles</span><span class="p">[</span><span class="s2">&quot;Axis a&quot;</span><span class="p">];</span>
    <span class="kd">let</span> <span class="nx">axes_b</span> <span class="o">=</span> <span class="nx">particles</span><span class="p">[</span><span class="s2">&quot;Axis b&quot;</span><span class="p">];</span>
    <span class="kd">let</span> <span class="nx">axes_c</span> <span class="o">=</span> <span class="nx">particles</span><span class="p">[</span><span class="s2">&quot;Axis c&quot;</span><span class="p">];</span>
    <span class="c1">// Loop through particles</span>
    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">radii</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">radius</span><span class="o">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">index</span><span class="o">:</span> <span class="nx">number</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Get the radius ratios</span>
      <span class="kd">let</span> <span class="nx">ratio</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="nx">radius</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="nx">radius</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">radius</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="nx">radius</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span>
      <span class="c1">// Get the axes into vectors and compute rotation matrix</span>
      <span class="kd">let</span> <span class="nx">axis_a</span> <span class="o">=</span> 
        <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">axes_a</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> 
                          <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">axes_a</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> 
                          <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">axes_a</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">2</span><span class="p">]));</span>
      <span class="kd">let</span> <span class="nx">axis_b</span> <span class="o">=</span> 
        <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">axes_b</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> 
                          <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">axes_b</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> 
                          <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">axes_b</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">2</span><span class="p">]));</span>
      <span class="kd">let</span> <span class="nx">axis_c</span> <span class="o">=</span> 
        <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">axes_c</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> 
                          <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">axes_c</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> 
                          <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">axes_c</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">2</span><span class="p">]));</span>
      <span class="kd">let</span> <span class="nx">rotMatrix</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Matrix4</span><span class="p">();</span>
      <span class="nx">rotMatrix</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span>
        <span class="nx">axis_a</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">axis_b</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">axis_c</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nx">axis_a</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">axis_b</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">axis_c</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nx">axis_a</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span> <span class="nx">axis_b</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span> <span class="nx">axis_c</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
        <span class="p">);</span>
      <span class="c1">// Create the sphere geometry</span>
      <span class="kr">const</span> <span class="nx">sph_geometry</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">SphereGeometry</span><span class="p">(</span><span class="nx">radius</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
      <span class="c1">// Rotate sphere </span>
      <span class="nx">sph_geometry</span><span class="p">.</span><span class="nx">applyMatrix</span><span class="p">(</span><span class="nx">rotMatrix</span><span class="p">);</span>
      <span class="c1">// Convert into ellipsoid</span>
      <span class="nx">sph_geometry</span><span class="p">.</span><span class="nx">applyMatrix</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Matrix4</span><span class="p">().</span><span class="nx">makeScale</span><span class="p">(</span><span class="nx">ratio</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">ratio</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">ratio</span><span class="p">[</span><span class="mi">2</span><span class="p">]));</span>
      <span class="c1">// Translate the geometry</span>
      <span class="kd">let</span> <span class="nx">center</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="nx">centers</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">centers</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="nx">centers</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">2</span><span class="p">]);</span>
      <span class="nx">sph_geometry</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="nx">center</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">center</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">center</span><span class="p">.</span><span class="nx">z</span><span class="p">);</span>
      <span class="c1">// Convert into buffer geometry</span>
      <span class="kr">const</span> <span class="nx">geometry</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">BufferGeometry</span><span class="p">().</span><span class="nx">fromGeometry</span><span class="p">(</span><span class="nx">sph_geometry</span><span class="p">);</span>
      <span class="c1">// Create the material for display purposes</span>
      <span class="kr">const</span> <span class="nx">material</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshPhongMaterial</span><span class="p">({</span>
        <span class="nx">color</span><span class="o">:</span> <span class="mh">0xffaa00</span><span class="p">,</span>
        <span class="nx">emissive</span><span class="o">:</span> <span class="mh">0x072534</span><span class="p">,</span>
        <span class="nx">side</span><span class="o">:</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">DoubleSide</span><span class="p">,</span>
        <span class="nx">shading</span><span class="o">:</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">SmoothShading</span><span class="p">,</span>
        <span class="nx">wireframe</span><span class="o">:</span> <span class="kc">false</span>
      <span class="p">});</span>
      <span class="c1">// Create the mesh</span>
      <span class="kr">const</span> <span class="nx">sphere</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="nx">geometry</span><span class="p">,</span> <span class="nx">material</span><span class="p">);</span>
      <span class="c1">// Save the data</span>
      <span class="nx">Store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;ADD_THREE_OBJECT&#39;</span><span class="p">,</span> <span class="nx">sphere</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="nx">Store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;THREE_OBJECTS_CREATED&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="p">}</span></code></pre></figure>

<p class="notice--info">The rotation matrix performs a transformation of the form
<script type="math/tex">\hat{\mathbf{w}} = \boldsymbol{R} \cdot \mathbf{w}\,.</script>
We want to rotate the world coordinate vectors
<script type="math/tex">\mathbf{E}_1</script>, <script type="math/tex">\mathbf{E}_2</script>, <script type="math/tex">\mathbf{E}_3</script>, 
into vectors that are aligned with the ellipsoid axes,
<script type="math/tex">\mathbf{e}_1</script>, <script type="math/tex">\mathbf{e}_2</script>, <script type="math/tex">\mathbf{e}_3</script>. 
Therefore, we need to find a rotation matrix <script type="math/tex">\boldsymbol{R}</script>
such that <script type="math/tex">\mathbf{e}_\alpha = \boldsymbol{R}\cdot\mathbf{E}_\alpha</script>
where <script type="math/tex">\alpha = 1,2,3</script>. Taking dot products of both sides with
<script type="math/tex">\mathbf{E}_\beta</script>, we get
<script type="math/tex">\mathbf{E}_\beta\cdot\mathbf{e}_\alpha =
\mathbf{E}_\beta\cdot\boldsymbol{R}\cdot\mathbf{E}_\alpha = 
(\mathbf{E}_\beta\otimes\mathbf{E}_\alpha):\boldsymbol{R} \,.</script> Now, <script type="math/tex">\boldsymbol{R} = R_{mn} \mathbf{E}_m \otimes \mathbf{E}_n</script>.
So we have
<script type="math/tex">\mathbf{E}_\beta\cdot\mathbf{e}_\alpha =
  R_{mn} (\mathbf{E}_\beta\otimes\mathbf{E}_\alpha): (\mathbf{E}_m \otimes \mathbf{E}_n)
  = R_{mn} (\mathbf{E}_\beta\cdot\mathbf{E}_m) (\mathbf{E}_\alpha \cdot \mathbf{E}_n)
  = R_{mn} \delta_{\beta m} \delta_{\alpha n}</script>.
Therefore, <script type="math/tex">\mathbf{E}_\beta\cdot\mathbf{e}_\alpha = R_{\beta\alpha}</script>.</p>

<p>Let us look at the ellipsoid axis vector <script type="math/tex">\mathbf{e}_1 = \mathbf{e}_a</script>.  This vector has
components <script type="math/tex">(e_{11}, e_{12}, e_{13})</script> where <script type="math/tex">e_{11} = \mathbf{e}_1 \cdot \mathbf{E}_1 = R_{11}</script>,
<script type="math/tex">e_{12} = \mathbf{e}_1 \cdot \mathbf{E}_2 = R_{21}</script>, and <script type="math/tex">e_{13} = \mathbf{e}_1 \cdot \mathbf{E}_3 = R_{31}</script>.  That is why we can create the rotation matrix directly from the axis data in
the code sample.</p>

<h4 id="remarks">Remarks</h4>
<p>A plot of the ellipsoids produced by our code can be seen below.</p>

<p><img src="https://bbanerjee.github.io/ParSim/assets/blogimg/ThreeGraphicsPanel.jpg" alt="Plot produced by Three.js" class="img-responsive center-image" height="450px" border="5px double red" /></p>

<p>In the next part of this series we will explore how <code>vtk.js</code> can be used to do the same plot.</p>

<p>If you have questions/comments/corrections, please contact banerjee at parresianz dot com dot zen (without the dot zen).</p>

<p><a class="twitter-share-button" href="https://twitter.com/intent/tweet" data-via="parresianz"> Tweet</a>
<script src="//platform.linkedin.com/in.js" type="text/javascript">
  lang: en_US
</script>
<script type="IN/Share" data-counter="right"></script></p>


          





  
  

  
  

  
  

  
  

  
  


        </article>
      </div>

      <div class="unit one-fifth hide-on-mobiles">
  <aside>
    
    <h4>Getting Started</h4>
    <ul>

  
  
  <li class=""><a href=""></a></li>

  
  
  <li class=""><a href=""></a></li>

  
  
  <li class=""><a href=""></a></li>

</ul>

    
    <h4>Vaango tutorials</h4>
    <ul>

  
  
  <li class=""><a href=""></a></li>

</ul>

    
    <h4>Vaango manuals</h4>
    <ul>

  
  
  <li class=""><a href=""></a></li>

</ul>

    
  </aside>
</div>


      <div class="clear"></div>

    </div>
  </section>


  <footer>
  <div class="grid">
    <div class="unit one-third center">
      <p>&copy;&nbsp;2017 under the terms of the <a href="https://github.com/bbanerjee/ParSim/blob/master/LICENSE">MIT&nbsp;License</a>.</p>
    </div>
    <div class="unit one-third align-right center">
      <p>
        Built with
        <a href="https://jekyllrb.com">
          <img src="https://bbanerjee.github.io/ParSim/assets/img/logo-2x.png" width = "70" height="30" alt="Jekyll">
        </a>
      </p>
    </div>
    <div class="unit one-third align-right center">
      <p>
        Hosted by
        <a href="https://github.com">
          <img src="https://bbanerjee.github.io/ParSim/assets/img/footer-logo.png" width="100" height="30" alt="GitHub • Social coding">
        </a>
      </p>
    </div>
  </div>
</footer>

  <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<span class=\"sr-only\">Permalink</span><i class=\"fa fa-link\"></i>";
    anchor.title = "Permalink";
    return anchor;
  };

  var linkifyAnchors = function (level, containingElement) {
    var headers = containingElement.getElementsByTagName("h" + level);
    for (var h = 0; h < headers.length; h++) {
      var header = headers[h];

      if (typeof header.id !== "undefined" && header.id !== "") {
        header.appendChild(anchorForId(header.id));
      }
    }
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var contentBlock = document.getElementsByClassName("docs")[0] || document.getElementsByClassName("news")[0];
      if (!contentBlock) {
        return;
      }
      for (var level = 1; level <= 6; level++) {
        linkifyAnchors(level, contentBlock);
      }
    }
  };
</script>

  
</body>
</html>
